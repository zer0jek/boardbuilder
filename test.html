<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Board</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        #gameBoard {
            display: grid;
            grid-template-columns: repeat(7, 100px);
            grid-template-rows: repeat(5, 100px);
            background-image: url('default.png');
            width: 700px;
            height: 500px;
            position: relative;
            margin: 20px auto;
        }
        .square {
            border: 1px solid #cccccc;
            position: relative;
        }
        .unit {
            width: 80%;
            height: 80%;
            position: absolute;
            top: 10%;
            left: 10%;
            pointer-events: none;
        }
        #unitSelection img {
            width: 50px;
            cursor: pointer;
            margin: 5px;
        }
        #colorPicker, #shadowToggle {
            margin: 20px;
        }
        #download {
            margin: 20px;
            display: block;
        }
    </style>
</head>
<body>

<h1>Game Board</h1>

<div id="gameBoard"></div>

<div id="unitSelection"></div>

<label for="colorPicker">Choose Shadow Color:</label>
<input type="color" id="colorPicker" value="#000000">
<button id="shadowToggle">Toggle Shadow</button>
<button id="clearUnits">Clear Units</button>
<a id="download" href="#" download="gameBoard.png">Download Image</a>

<script>
    const gameBoard = document.getElementById('gameBoard');
    const unitSelection = document.getElementById('unitSelection');
    const downloadLink = document.getElementById('download');
    const colorPicker = document.getElementById('colorPicker');
    const shadowToggle = document.getElementById('shadowToggle');
    const clearUnits = document.getElementById('clearUnits');
    
    let selectedUnitImage = '';
    let shadowEnabled = false;
    let shadowColor = '#000000';

    // Generate unit images
    for (let i = 0; i < 30; i++) {
        const img = document.createElement('img');
        img.src = `image${i}.png`;
        img.id = `unit${i}`;
        img.onclick = () => selectUnit(img.src);
        unitSelection.appendChild(img);
    }

    // Create the game board squares
    for (let i = 0; i < 35; i++) {
        const square = document.createElement('div');
        square.className = 'square';
        square.onclick = () => placeUnit(square);
        gameBoard.appendChild(square);
    }

    function selectUnit(src) {
        selectedUnitImage = src;
    }

    function placeUnit(square) {
        if (selectedUnitImage) {
            const unit = document.createElement('img');
            unit.src = selectedUnitImage;
            unit.className = 'unit';
            unit.style.filter = shadowEnabled ? `drop-shadow(0px 0px 10px ${shadowColor})` : 'none';
            square.appendChild(unit);
        }
    }

    shadowToggle.onclick = () => {
        shadowEnabled = !shadowEnabled;
        shadowToggle.innerText = shadowEnabled ? 'Disable Shadow' : 'Enable Shadow';
    };

    clearUnits.onclick = () => {
        Array.from(document.querySelectorAll('.square')).forEach(square => {
            while (square.firstChild) {
                square.removeChild(square.firstChild);
            }
        });
    };

    // Download image functionality
    downloadLink.onclick = () => {
        html2canvas(gameBoard).then(canvas => {
            const dataURL = canvas.toDataURL('image/png');
            downloadLink.href = dataURL;
            // Show the generated image before downloading
            const imgPreview = document.createElement('img');
            imgPreview.src = dataURL;
            imgPreview.style.width = '100%';
            document.body.appendChild(imgPreview);
        });
    };

    // Add color pick functionality
    colorPicker.oninput = (event) => {
        shadowColor = event.target.value;
    };
</script>

<!-- Include html2canvas script for capturing the board -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

</body>
</html>
